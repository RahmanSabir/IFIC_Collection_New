<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="ISO-8859-1"></meta>
    <title>Reason for Classification</title>
</head>
<body>
<div id="layout-cibReport" th:fragment="reason-for-classification-tap">
    <div class="csi-view-form-full-area csi-view-indtable">
        <div class="box-header with-border csi-view-box-header">
            <h3 class="box-title" ></h3>

        </div>

        <div class="box-body" id="reasonForClassification">
            <div class="form-horizontal csi-view-form" id="account_escalation">
                <div class="row form-group">
                    <label  class="col-sm-3 custom-form-lebel-right" style="padding-top: 40px">Borrower's point of view:</label>
                    <div class="col-sm-9">
                        <textarea v-model="borrowerPointOfView" name="borrowerPointOfView" rows="4" class="form-control"></textarea>
                    </div>
                </div>
                <div class="row form-group">
                    <label  class="col-sm-3 custom-form-lebel-right" style="padding-top: 40px">Bank's point of view:</label>
                    <div class="col-sm-9">
                        <textarea v-model="bankPointOfView" name="bankPointOfView" rows="4" class="form-control"></textarea>
                    </div>
                </div>
                <div class="pull-right">
                    <a href="#" v-if="enabled" class="btn btn-success" @click="addData" id="btn_ingresar">Update
                    <a href="#" v-else class="btn btn-success" @click="addData" >Submit</a>
                </div>
            </div>
            <script th:inline="javascript">
                /*<![CDATA[*/

                // var backgroundOfTheBorrowerEntity = /*[[${backgroundOfTheBorrowerEntity}]]*/ {};

                $("#tab-reason-for-classification").click(function (event) {
                    //event.preventDefault();
                    reasonForClassification.getFindData();
                });

                /*]]>*/
            </script>

            <script>
                var reasonForClassification = new Vue({
                    el:'#reasonForClassification',
                    data:{
                        accountNo:"",
                        borrowerPointOfView:"",
                        bankPointOfView:"",
                        enabled:null
                    },
                    methods:{
                        getFindData:function (){
                            var host = window.location.host;
                            this.accountNo = accountNo;
                            var url = 'https://'+host+'/collection/samd/reason-for-classification/create?id='+accountNo;

                            this.$http.get(url, {credentials : true, headers:{'X-CSRF-TOKEN' : window.csrfToken,}})
                                .then(res => {

                                if(res.body){
                                this.borrowerPointOfView = res.body.borrowerPointOfView;
                                this.bankPointOfView = res.body.bankPointOfView;
                                this.enabled = res.body.id;
                            }
                        }).catch(err => {
                                console.log(err);
                        })
                        },
                        addData:function () {
                            var host = window.location.host;
                            this.$http.post('https://'+host+'/collection/samd/reason-for-classification/save',{
                                    account:accountNo,
                                    borrowerPointOfView:this.borrowerPointOfView,
                                    bankPointOfView:this.bankPointOfView
                                },
                                {credentials : true, headers:{
                                        'X-CSRF-TOKEN' : window.csrfToken,
                                    }}).then(res => {
                                this.getFindData();
                            alert("Successfully save")

                        }).catch(err => {
                                console.log(err);
                        })
                        },

                    }
                })
            </script>
        </div>
    </div>
</div>
</body>


</html>
