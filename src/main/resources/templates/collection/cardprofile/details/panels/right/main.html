<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:v-bind="http://www.w3.org/1999/xhtml">
    <head>
        <meta charset="ISO-8859-1"/>
        <title>360 Page -Right Side</title>
        <script th:src="@{/js/common.js}"></script>
    </head>
<body>
<div th:fragment="panel-right-collection-card">


    <!--hot note list view-->
    <div class="box box-primary ">
        <div class="box-header with-border">
            <h2 class="box-title label label-danger" style="margin-top: 10px;">Hot Note</h2>
            <a class=" btn btn-xs btn-primary pull-right" data-toggle="modal" data-target="#modal-hotnotee">
                <i class="fa fa-plus-square"></i>
                Add More
            </a>
        </div>

        <div class="box-body">

            <div class="row">
                <div class="col-md-12" style="max-height: 150px; overflow-y: auto;">
                    <table class="table   table-hover table-bordered">
                        <thead>
                        <th>Vip Status</th>
                        <th>Hot Note</th>
                        <th>Creator</th>
                        </thead>
                        <tbody id="hot-list">
                        <tr th:each="hot : ${hotNotes}">
                            <td th:text="${hot?.vipStatus}"></td>
                            <td th:text="${hot?.hotNote}"></td>
                            <td th:text="${hot?.username + '-' + hot?.createdBy + '/' +hot?.createdDate}"></td>

                        </tr>
                        </tbody>
                        <script>
                            function dateformat() {
                                var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                                    "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
                                ];
                                if (value) {
                                    var date = new Date(value);
                                    var day = date.getDate();
                                    if (day < 10) day = '0' + day;
                                    var hours = date.getHours();
                                    var minutes = date.getMinutes();
                                    var newFormat = hours >= 12 ? "PM" : "AM";
                                    hours = hours % 12;
                                    hours = hours ? hours : 12;
                                    minutes = minutes < 10 ? '0' + minutes : minutes;
                                    return day + '-' + monthNames[date.getMonth()] + '-' + date.getFullYear().toString() + ' / ' + hours + ':' + minutes + ' ' + newFormat;
                                } else {
                                    return "";
                                }
                            } {

                            }
                        </script>
                    </table>
                </div>
            </div>

        </div>
        <div class="modal fade" id="modal-hotnotee">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Create a Hot Note</h4>
                    </div>
                    <form id="hotNoteSaveForm" action="" method="post" class="form-horizontal" onsubmit="hotNoteSave();return false;">

                        <input type="hidden" th:value="${cardCustomerInfo.id}" name="customerBasicInfo.id"/>
                        <div class="modal-body">
                            <label>Select Vip Status</label>
                            <select name="vipStatus" class="form-control">
                                <option>Select</option>
                                <option th:each="vipStatus : ${vipStatusList}"
                                        th:value="${vipStatus.name}" th:text="${vipStatus.name}"></option>
                            </select>
                            <label>Enter Details Here </label>
                            <textarea maxlength="500" class="form-control" rows="3" style="resize: none" placeholder="Enter Details Here" name="hotNote" th:required="true"></textarea>
                            <label>Status</label>
                            <select name="statusFlag" class="form-control">
                                <option value="true">Marked as Flag</option>
                                <option value="false">Not Marked</option>
                            </select>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger pull-left" data-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary">Save</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!--all activity taken-->
    <div class="box box-primary">
        <div class="box-header with-border">
            <h3 class="box-title" style="margin-top: 10px;">Activities Taken</h3>
            <a class=" btn btn-primary btn-xs pull-right" onclick="ptpdetails()" data-toggle="modal" data-target="#modal-ptp">
                <i class="fa fa-plus-square"></i>
                Add More
            </a>
        </div>
    </div>

    <div class="box box-primary">
        <div class="box-header with-border">
            <h3 class="box-title" style="margin-top: 10px;">Consideration as Attempt</h3>
        </div>

        <!-- /.box-header -->
        <div class="box-body">
            <div class="row">
                <div class="col-md-12" style="max-height: 150px; overflow-y: auto;">
                    <table class="table table-striped table-hover table-bordered">
                        <thead>
                        <td>Creator</td>
                        <td>Consideration as Attempt</td>
                        </thead>
                        <tbody id="card-contact-list">
                        <tr v-for="contact in contactList">
                            <td :title="contact.createdBy+'-'+(contact.pin)+'/'+customDateFormat(contact.createdDate)">{{contact.createdBy}}-({{contact.pin}})</td>
                            <td>{{contact.attempt}}</td>
                        </tr>
                        </tbody>
                        <script>
                            var contactInfo = new Vue({
                                el: '#card-contact-list',
                                data: {
                                    contactList: [],
                                },
                                created: function () {

                                    console.log(customerId);
                                    var host = window.location.host;
                                    var url = 'https://' + host + '/customerCardProfile/contactInfoCard/list?id=' + custId;

                                    this.$http.get(url,
                                        {
                                            credentials: true, headers: {
                                                'X-CSRF-TOKEN': window.csrfToken,
                                            }
                                        }).then(res => {
                                        if (res.body) {
                                        this.contactList = res.body;
                                    }
                                }).catch(err => {
                                        console.log(err);
                                })
                                },
                                filters: {
                                    dateFormat: function (value) {
                                        var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                                            "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
                                        ];
                                        if (value) {
                                            var date = new Date(value);
                                            var day = date.getDate();
                                            if (day < 10) day = '0' + day;
                                            var hours = date.getHours();
                                            var minutes = date.getMinutes();
                                            var newFormat = hours >= 12 ? "PM" : "AM";
                                            hours = hours % 12;
                                            hours = hours ? hours : 12;
                                            minutes = minutes < 10 ? '0' + minutes : minutes;
                                            return day + '-' + monthNames[date.getMonth()] + '-' + date.getFullYear().toString() + ' / ' + hours + ':' + minutes + ' ' + newFormat;
                                        } else {
                                            return "";
                                        }
                                    }
                                },
                                methods: {
                                    upDateContactList: function (list) {
                                        this.contactList = list;
                                    },
                                    customDateFormat(value){
                                        var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                                            "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
                                        ];
                                        if (value) {
                                            var date = new Date(value);
                                            var day = date.getDate();
                                            if (day < 10) day = '0' + day;
                                            var hours = date.getHours();
                                            var minutes = date.getMinutes();
                                            var newFormat = hours >= 12 ? "PM" : "AM";
                                            hours = hours % 12;
                                            hours = hours ? hours : 12;
                                            minutes = minutes < 10 ? '0' + minutes : minutes;
                                            return day + '-' + monthNames[date.getMonth()] + '-' + date.getFullYear().toString() + ' / ' + hours + ':' + minutes + ' ' + newFormat;
                                        } else {
                                            return "";
                                        }
                                    }
                                }

                            })
                        </script>
                    </table>
                </div>
            </div>

        </div>
        <script type="text/javascript" th:src="@{/collection/cardprofile/contactInfoCard.js}"></script>
    </div>

    <div class="box box-primary">
        <div class="box-header with-border">
            <h3 class="box-title" style="margin-top: 10px;">Consideration as Contact</h3>
        </div>

        <!-- /.box-header -->
        <div class="box-body">
            <div class="row">
                <div class="col-md-12" style="max-height: 150px; overflow-y: auto;">
                    <table class="table table-striped table-hover table-bordered">
                        <thead>
                        <td>Creator</td>
                        <td>Consideration as Contact</td>
                        <td>Contact Category</td>
                        </thead>
                        <tbody id="contactOne-list">
                        <tr v-for="contactone in contactList">
                            <td :title="contactone.createdBy+'-'+(contactone.pin)+'/'+customDateFormat(contactone.createdDate)">{{contactone.createdBy}}-({{contactone.pin}})</td>
                            <td>{{contactone.contact}}</td>
                            <td>{{contactone.category}}</td>
                        </tr>
                        </tbody>

                        <script>
                            var contactInfoone = new Vue({
                                el: '#contactOne-list',
                                data: {
                                    contactList: [],
                                },
                                created: function () {
                                    var host = window.location.host;
                                    var url = 'https://' + host + '/customerCardProfile/contactInfoCard/list?id=' + custId;
                                    this.$http.get(url,
                                        {
                                            credentials: true, headers: {
                                                'X-CSRF-TOKEN': window.csrfToken,
                                            }
                                        }).then(res => {
                                        if (res.body) {
                                        this.contactList = res.body;
                                    }
                                }).catch(err => {
                                        console.log(err);
                                })
                                },
                                filters: {
                                    dateFormat: function (value) {
                                        var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                                            "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
                                        ];
                                        if (value) {
                                            var date = new Date(value);
                                            var day = date.getDate();
                                            if (day < 10) day = '0' + day;
                                            var hours = date.getHours();
                                            var minutes = date.getMinutes();
                                            var newFormat = hours >= 12 ? "PM" : "AM";
                                            hours = hours % 12;
                                            hours = hours ? hours : 12;
                                            minutes = minutes < 10 ? '0' + minutes : minutes;
                                            return day + '-' + monthNames[date.getMonth()] + '-' + date.getFullYear().toString() + ' / ' + hours + ':' + minutes + ' ' + newFormat;
                                        } else {
                                            return "";
                                        }
                                    }
                                },
                                methods: {
                                    upDateContactList: function (list) {
                                        this.contactList = list;
                                    },
                                    customDateFormat(value){
                                        var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                                            "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
                                        ];
                                        if (value) {
                                            var date = new Date(value);
                                            var day = date.getDate();
                                            if (day < 10) day = '0' + day;
                                            var hours = date.getHours();
                                            var minutes = date.getMinutes();
                                            var newFormat = hours >= 12 ? "PM" : "AM";
                                            hours = hours % 12;
                                            hours = hours ? hours : 12;
                                            minutes = minutes < 10 ? '0' + minutes : minutes;
                                            return day + '-' + monthNames[date.getMonth()] + '-' + date.getFullYear().toString() + ' / ' + hours + ':' + minutes + ' ' + newFormat;
                                        } else {
                                            return "";
                                        }
                                    }
                                }

                            })
                        </script>
                    </table>
                </div>
            </div>

        </div>
        <script type="text/javascript" th:src="@{/collection/cardprofile/contactInfoCard.js}"></script>
    </div>

    <div class="box box-primary">
        <div class="box-header with-border">
            <h3 class="box-title" style="margin-top: 10px;">Reason For Delinquency</h3>
        </div>

        <!-- /.box-header -->
        <div class="box-body">
            <div class="row" id="reasonDelinquencyAppsId">
                <div class="col-md-12" style="max-height: 150px; overflow-y: auto;">
                    <table class="table table-striped table-hover table-bordered">
                        <thead>
                        <td>Creator</td>
                        <td>Date</td>
                        <td>Reason</td>
                        </thead>
                        <tbody>
                        <tr v-for="data in list">
                            <td>{{data.createdBy+'-'+data.dealerName}}</td>
                            <td>{{formatDate(data.createdDate)}}</td>
                            <td>{{data.reasonDeline}}</td>
                        </tr>

                        </tbody>
                    </table>
                </div>
            </div>

            <script th:inline="javascript">
                /*<![CDATA[*/
                var customerId = /*[[${customerId}]]*/ [];
                /*]]>*/
            </script>

            <script>


                var reasonDelinquencyApps = new Vue({
                    el: '#reasonDelinquencyAppsId',
                    data: {
                        list: []
                    },
                    created:function(){
                        //getReasonDelinquency(customerId);
                    },
                    methods:{
                        endureTwoDigitDay:function (value) {
                            if (!value) return '';
                            value = value.toString();
                            if (value.length < 2)
                                value = '0' + value;
                            else if (value.length > 2)
                                value = value.substr(0, 2);
                            return value;
                        },
                        isValidDate:function (dateString_yyyy_mm_dd) {
                            if (typeof dateString_yyyy_mm_dd === 'string') {
                                return dateString_yyyy_mm_dd.match(/^\d{4}-([01]?[0-9])-([0-2]?[0-9])$/) ||
                                    dateString_yyyy_mm_dd.match(/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/) ||
                                    dateString_yyyy_mm_dd.match(/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/);
                            } else if (dateString_yyyy_mm_dd && typeof dateString_yyyy_mm_dd.getMonth === 'function') {
                                return true;
                            }
                            return false;
                        },
                        formatDate_DD_MM_YYYY:function (dateString_yyyy_mm_dd, delimeter = ".") {
                            if (!this.isValidDate(dateString_yyyy_mm_dd)) return dateString_yyyy_mm_dd;
                            let date = new Date(dateString_yyyy_mm_dd);
                            return this.endureTwoDigitDay(date.getDate()) + delimeter + this.endureTwoDigitDay(date.getMonth() + 1) + delimeter + date.getFullYear();
                        },
                        formatDate: function (date) {
                            return this.formatDate_DD_MM_YYYY(date)
                        }
                    }
                })


                var getReasonDelinquency;

                $('document').ready(function () {

                    getReasonDelinquency = function (customerId) {
                        var custId = customerId;
                        $.ajax({
                            url: '/collection/card/reasonForDelinquency/findBy?id='+custId,
                            success: function (response) {
                                reasonDelinquencyApps.list = response;
                            },
                            error: function (response) {
                                alert('Unsuccessful');
                            }
                        })
                    }
                    getReasonDelinquency(custId);
                })
            </script>

        </div>
        <script type="text/javascript" th:src="@{/collection/cardprofile/contactInfoCard.js}"></script>
    </div>

    <!--daily notes/ memo list view-->
    <div class="box box-primary">
        <div class="box-header with-border">
            <h3 class="box-title" style="margin-top: 10px;">Note Detail</h3>
        </div>

        <div class="box-body" id="dailyNoteMemoApp">
            <div class="row">
                <div class="col-md-12">
                    <table style="overflow: auto" class="table   table-hover table-bordered">
                        <thead>
                        <th>Creator</th>
                        <th>Memo Note</th>
                        </thead>
                        <tbody>
                        <tr v-for="memo in memoNoteList">
                            <td>{{memo.name+'-'+memo.createdBy}}</td>
                            <td>{{memo.note}}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <script th:inline="javascript">
            /*<![CDATA[*/
            var dailyNoteList = /*[[${dailyNotes}]]*/ [];
            /*]]>*/
        </script>
        <script>
            var dailyNoteApp = new Vue({
                el:"#dailyNoteMemoApp",
                data:{
                    memoNoteList:[]
                },
                created: function () {
                    this.memoNoteList=dailyNoteList;
                },
                computed:{

                },
                methods:{
                     getAll: async function(id){
                        var memoNoteList = [];
                        await $.get('/collection/card/daily-notes/list?cusId='+id).then(response=>{
                            memoNoteList=response;
                        }).catch();
                        this.memoNoteList = memoNoteList;
                    },
                }
            });
        </script>
    </div>

    <!--follow up list view-->
    <div class="box box-primary">
        <div class="box-header with-border">
            <h3 class="box-title">Follow up</h3>
        </div>

        <div class="box-body">
            <div class="form-horizontal csi-view-form" id="follow-up">
                <input class="gen-card-id" type="hidden" name="cardId" th:value="${cdi}"/>
                <input type="hidden" name="refId" id="refId" th:value="${refId}"/>
                <table name="reference_info" id="follow_up"
                       class=" table   table-bordered">
                    <thead class="thead-light">
                    <tr>
                        <th>Creator</th>
                        <th>Follow up Date</th>
                        <th>Activity</th>
                    </tr>
                    </thead>
                    <tbody id="card_followup_tBody">
                    <tr th:each="followup :${folllowups}">
                        <td th:text="${followup?.username+ '-' + followup?.createdBy}"></td>
                        <td th:text="${#dates.format(followup.followUpDate, 'dd-MMM-yyyy')+'/'+followup?.followUpTimes}"></td>
                        <td>
                            <ul style="display: inline; padding: 0px;" th:each="reason :${followup.followUpReason}">
                                <li style="list-style: none" th:text="${reason}"></li>
                            </ul>
                        </td>
                    </tr>
                    </tbody>
                </table>

            </div>
        </div>

        <div class="modal fade" id="modal-follow-up">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Follow Up</h4>
                    </div>
                    <form id="card_followUp_Form" action="" method="post" class="form-horizontal">
                        <input type="hidden" th:value="${cardCustomerInfo.id}" name="customerBasicInfo.id"/>
                        <div class="modal-body">
                            <div class="form-group">
                                <label for="datepicker" class="col-sm-2 control-label"> Date</label>

                                <div class="col-sm-10">
                                    <div class="input-group date">
                                        <div class="input-group-addon">
                                            <i class="fa fa-calendar"></i>
                                        </div>
                                        <input type="date" name="followUpDate" class="form-control pull-right datepicker" id="datepicker">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 custom-details-lebel-left">Choose Time</label>
                                <div class="col-sm-10">
                                    <div class="input-group date">
                                        <input type="time" name="followUpTimes" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="checkbox" class="col-sm-2 control-label">Activity</label>

                                <div class="col-sm-10">
                                    <div class="checkbox">
                                        <label class="col-sm-2">
                                            <input class="ads_Checkbox " type="checkbox" id="checkbox" value="Call">
                                            Call
                                        </label>
                                        <label class="col-sm-2">
                                            <input class="ads_Checkbox " type="checkbox" id="checkbox1" value="SMS">
                                            SMS
                                        </label>
                                        <label class="col-sm-2">
                                            <input class="ads_Checkbox " type="checkbox" id="checkbox2" value="Email">
                                            Email
                                        </label>
                                        <label class="col-sm-2">
                                            <input class="ads_Checkbox " type="checkbox" id="checkbox3" value="Letter">
                                            Letter
                                        </label>
                                        <label class="col-sm-2">
                                            <input class="ads_Checkbox " type="checkbox" id="checkbox4" value="Visit">
                                            Visit
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!--ptp list-->
    <div class="box box-primary">
        <div class="box-header with-border">
            <h3 class="box-title">PTP</h3>
        </div>
        <div class="box-body">
            <div class="box-body" id="card_ptp">
                <div class="form-horizontal csi-view-form" id="ptp" style="max-height: 150px; overflow-y: auto;">
                    <table name="ptp_info" id="ptpinfo"
                           class="table table-striped table-bordered">
                        <thead class="thead-light">
                        <tr>
                            <th>Creator</th>
                            <th>Amount</th>
                            <th>PTP Date</th>
                            <th>Time</th>
                            <th>Remarks</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                        </thead>
                        <tbody id="ptptBody">

                        </tbody>
                    </table>
                </div>
            </div>
            <script th:inline="javascript">
                var ptplist = /*[[${ptps}]]*/ [];
            </script>
            <script>
                var card_ptp = new Vue({
                    el: '#card_ptp',
                    data: {
                        card_ptp_details: [],
                    },
                    created: function () {
                        this.card_ptp_details = JSON.parse(ptplist) != null ? JSON.parse(ptplist) : [];
                        for (var i = 0; i < this.card_ptp_details.length; i++) {

                            let date = new Date(this.card_ptp_details[i].card_ptp_date);

                            let date1 = new Date();
                            date1.setHours(0);
                            date1.setMinutes(0);
                            date1.setSeconds(0);

                            var str1 = '';
                            var str2 = '';
                            let b = date >= date1;
                            if (b) {
                                str1 = "<a style=\"margin-bottom:2px\" class=\"btn btn-xs btn-info\" onclick=\"card_ptp_editRow(this," + this.card_ptp_details[i].card_contact_details_id + "," + this.card_ptp_details[i].card_contact_location_id + "," + this.card_ptp_details[i].card_promisor_details_id + ")\"> <i class=\"fa fa-edit\"></i></a>"
                                str2 = "<a style=\"margin-bottom:2px\" class=\"btn btn-xs btn-danger\" onclick=\"card_ptp_deleteRow(this)\"> <i class=\"fa fa-trash\"></i></a>";
                            }

                            var str = "<tr>" +

                                "<td style=\"display:none;\">" + this.card_ptp_details[i].id + "</td>" +
                                "<td >" + this.card_ptp_details[i].username + '-' + this.card_ptp_details[i].pin +"</td>" +
                                "<td >" + this.card_ptp_details[i].card_amount + "</td>" +
                                "<td >" + this.card_ptp_details[i].card_ptp_date + "</td>" +
                                "<td >" + this.card_ptp_details[i].card_ptp_time + "</td>" +
                                "<td >" + this.card_ptp_details[i].card_remarks + "</td>" +
                                "<td >" + this.card_ptp_details[i].card_ptp_status + "</td>" +
                                "<td>" + str2 + str1 + "<a class=\"btn btn-xs btn-info\" oncli" +
                                "ck=\"card_ptp_viewRow(this)\"> <i class=\"fa fa-eye\"></i></a>" + "</td>" +
                                "</tr>";
                            $('#ptptBody').append(str);
                        }
                    }
                })
            </script>
        <div class="row">
            <div class="modal fade" id="modal-ptp" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog" style="width: 80%">
                    <div class="modal-content col-sm-12" style="border-radius: 8px">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                X
                            </button>
                        </div>
                        <style>
                            .vdp-datepicker input {
                                width: 100%;
                                padding: 7px;
                                border: 1px solid #f1f1f1;
                                border-color: #d2d6de;
                            }

                        </style>

                        <div class="col-sm-12">
                            <div class="box box-primary" >
                                <div class="csi-view-form-full-area csi-view-indtable col-sm-6" id="considerAttemptId" style="padding-bottom: 48px; !important;">
                                    <div class="box-header with-border csi-view-box-header">
                                        <label class="box-title" >Consideration as Attempt</label>
                                    </div>
                                    <div class="box-body" >
                                        <div id="considerAttemptId">
                                            <form id="considerAttemptForm" action="" method="post" class="form-horizontal">
                                                <input type="hidden"  th:value="${cardCustomerInfo.id}" id="considerationAttemptCustomerId"
                                                       name="customerBasicInfo.id"/>
                                                <div class="">
                                                    <input type="hidden" name="consider_attempt_details" id="consider_attempt" value=""/>
                                                    <input type="hidden" name="considet_contact_details" id="considet_contact" value=""/>
                                                    <input type="hidden" name="contact category_details" id="contact category" value=""/>
                                                    <div class="form-group">
                                                        <br>
                                                        <br>
                                                        <label class="col-sm-2 control-label">Consideration as Attempt</label>
                                                        <div class="col-sm-10">
                                                            <select id="consider_attempt_id" name="attempt" class="form-control consider-attempt-card" required='required' >
                                                                <option value="">Select One</option>
                                                                <option v-for="data in considerAttemptList" v-bind:value="data.attemptName">{{data.attemptName}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <br>
                                                        <label class="col-sm-2 control-label">Consideration as Contact</label>
                                                        <div class="col-sm-4">
                                                            <select id="considet_contact_id" name="contact"
                                                                    class="form-control" required='required'>
                                                                <option value="">Select One</option>
                                                            </select>
                                                        </div>
                                                        <label class="col-sm-2 control-label">Contact Category</label>
                                                        <div class="col-sm-4">
                                                            <select id="contact_category_id" name="category"
                                                                    class="form-control" required='required'>
                                                                <option value="">Select One </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>


                                <script>
                                    var considerAttemptApp = new Vue({
                                        el: '#considerAttemptId',
                                        data: {
                                            considerAttemptList: [],
                                            considerAttemptListById: []
                                        },

                                    })

                                    $(document).ready(function () {

                                        function considerAttemptList(customerId) {
                                            $.ajax({
                                                url: "/collection/considerAttempt/attemptList/card",
                                                success: function (data) {
                                                    considerAttemptApp.considerAttemptList= data;
                                                },
                                                error: function (data) {
                                                    //alert("Failure!");
                                                }
                                            });
                                        }
                                        considerAttemptList(customerId);

                                        $('#consider_attempt_id').on('change', function () {
                                            let id = $(this).val();
                                            $('#considet_contact_id, #ptp_contact_details_id').html('<option value="">Select One </option>')
                                            $('#contact_category_id, #ptp_promisor_details_id').html('<option value="">Select One </option>')

                                            if (!!id) {
                                                let selected = considerAttemptApp.considerAttemptList.filter(item => item.attemptName == id ? true : false);
                                                if (selected[0].considerContact != null) $('#considet_contact_id').append('<option value="'+selected[0].considerContact+'" selected="selected">'+selected[0].considerContact+'</option>');
                                                if (selected[0].considerContact != null){
                                                    $('#ptp_contact_details_id,#ptp_contact_details_id_single').append('<option value="'+selected[0].id+'" selected="selected">'+selected[0].considerContact+'</option>');
                                                    $('#ptp_contact_details').val(selected[0].considerContact)
                                                }
                                                if (selected[0].contactCategory != null) $('#contact_category_id').append('<option value="'+selected[0].contactCategory+'" selected="selected">'+selected[0].contactCategory+'</option>');
                                                if (selected[0].contactCategory != null){
                                                    $('#ptp_promisor_details_id').append('<option value="'+selected[0].id+'" selected="selected">'+selected[0].contactCategory+'</option>');
                                                    $('#ptp_promisor_details').val(selected[0].contactCategory)
                                                }
                                            }
                                        })
                                    })

                                </script>

                                <div class="csi-view-form-full-area csi-view-indtable col-sm-6">
                                    <div class="box-header with-border csi-view-box-header">
                                        <label class="box-title" >Follow Up</label>
                                    </div>
                                    <div class="box-body" >
                                        <form id="card_followUpForm" action="" method="post" class="form-horizontal">
                                            <input type="hidden" th:value="${cardCustomerInfo.id}" name="customerBasicInfo.id"/>
                                                <div class="form-group">
                                                    <label for="datepicker" class="col-sm-2 control-label"> Date</label>
                                                    <div class="col-sm-4">
                                                        <div class="input-group date">
                                                            <div class="input-group-addon">
                                                                <i class="fa fa-calendar"></i>
                                                            </div>
                                                            <input type="text" name="temdates" class="form-control pull-right datepicker follow-up-date-card" id="datepicker">
                                                        </div>
                                                    </div>
                                                    <label for="time" class="col-sm-2 control-label">Time</label>
                                                    <div class="col-sm-4">
                                                        <div class="input-group">
                                                            <div class="input-group-addon">
                                                                <i class="fa fa-clock-o"></i>
                                                            </div>
                                                            <input type="text" name="followUpTimes" class="form-control timepicker" id="time">
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label for="checkbox" class="col-sm-2 control-label">Activity</label>

                                                    <div class="col-sm-10">
                                                        <div class="checkbox">
                                                            <label class="col-sm-2">
                                                                <input class="ads_Checkbox " type="checkbox" id="checkbox" value="Call">
                                                                Call
                                                            </label>
                                                            <label class="col-sm-2">
                                                                <input class="ads_Checkbox " type="checkbox" id="checkbox1" value="SMS">
                                                                SMS
                                                            </label>
                                                            <label class="col-sm-2">
                                                                <input class="ads_Checkbox " type="checkbox" id="checkbox2" value="Email">
                                                                Email
                                                            </label>
                                                            <label class="col-sm-2">
                                                                <input class="ads_Checkbox " type="checkbox" id="checkbox3" value="Letter">
                                                                Letter
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                        </form>
                                    </div>
                                    <div style="border:inherit">

                                    </div>
                                    <div class="box-body" >
                                        <div class="box-header with-border csi-view-box-header">
                                            <label class="box-title" >Reason For Delinquency</label>
                                        </div>
                                        <form id="reasonForDelinquencyFormCard" action="" method="post" class="form-horizontal">
                                            <input type="hidden" th:value="${cardCustomerInfo.id}" name="customerBasicInfo.id"/>
                                            <input type="hidden" name="_csrf"/>
                                                <!-- select -->
                                                <div class="form-group">
                                                    <br>
                                                    <label class="col-sm-4 control-label">Reason For Delinquency</label>
                                                    <div class="col-sm-8">
                                                        <select name="reasonDeline" id="select-reason-delinquency" class="form-control reason-delinquency-card">

                                                        </select>
                                                    </div>
                                                </div>
                                        </form>
                                        <script>
                                            async function saveReasonForDelinquencyCard() {
                                                var boolenmesg=false;


                                                var formValue = $("#reasonForDelinquencyFormCard").serialize();
                                                var token = $("meta[name='_csrf']").attr("content");
                                                var header = $("meta[name='_csrf_header']").attr("content");

                                               await $.ajax({
                                                    type:"post",
                                                    url:"/collection/card/reasonForDelinquency/save",
                                                    beforeSend: function (xhr) {
                                                        xhr.setRequestHeader(header, token);
                                                    },
                                                    data:formValue,
                                                    success:function (data) {
                                                        // swal("Successfully saved !!");
                                                         boolenmesg=true;
                                                        $('#select-reason-delinquency').val('');
                                                        getReasonDelinquency(custId);
                                                    }
                                                })
                                                return boolenmesg
                                            }

                                            $(document).ready(function () {

                                                $('#reasonForDelinquencyFormCard input[name="_csrf"]').val(csrfToken);

                                                function getMemoNote() {

                                                    $.ajax({
                                                        url: '/collection/dnote_menu/find-list',
                                                        success: function (response) {
                                                            console.log('dairy note')
                                                            console.log(response);
                                                            var opt = [];
                                                            opt.push('<option value="">'+'Select One'+'</option>');
                                                            for (var i = 0; i< response.length; i++){
                                                                opt.push('<option value="'+response[i].name+'">'+response[i].name+'</option>');
                                                            }
                                                            $('#select-reason-delinquency').append($(opt.join('')));
                                                        },
                                                        error: function (response) {
                                                            alert('Unsuccessful');
                                                        }
                                                    })

                                                }
                                                getMemoNote();
                                            })
                                        </script>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-primary col-sm-12">
                            <div class="csi-view-form-full-area csi-view-indtable col-sm-6">
                                <div class="box-header with-border csi-view-box-header">
                                    <label class="box-title" >PTP</label>
                                </div>
                                <div class="box-body" >
                                    <form id="card_ptpForm" action="" method="post" class="form-horizontal">
                                        <input type="hidden" id="cardptpcustomerId" th:value="${cardCustomerInfo.id}" name="customerBasicInfo.id"/>
                                        <input type="hidden" name="card_contact_details" id="ptp_contact_details" value=""/>
                                        <input type="hidden" name="card_contact_location" id="ptp_location_details" value=""/>
                                        <input type="hidden" name="card_promisor_details" id="ptp_promisor_details" value=""/>
                                        <input type="hidden" name="id" id="id" value=""/>
                                        <input type="hidden" name="card_ptp_dates" v-model="getDate"/>

                                        <div class="form-group">
                                            <label class="col-sm-2 control-label"> Amount </label>
                                            <div class="col-sm-4">
                                                <input type="number" class="form-control ptp-amount-card" id="card_amount" name="card_amount" placeholder="Amount">
                                            </div>
                                            <label class="col-sm-2 control-label">Contact Details</label>
                                            <div class="col-sm-4">
                                                <select id="ptp_contact_details_id" name="card_contact_details_id"
                                                        class="form-control ">
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">Contact Location</label>
                                            <div class="col-sm-4">
                                                <input type="text"  name="contactLoacation" v-model="customerLocationAutoSelect" class="form-control" disabled/>
                                            </div>

                                            <label class="col-sm-2 control-label">Promisor Details</label>
                                            <div class="col-sm-4">
                                                <select id="ptp_promisor_details_id" name="card_promisor_details_id"
                                                        class="form-control" required='required'>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label for="card_ptp_date" class="col-sm-2 control-label">Date</label>
                                            <div class="col-sm-4">
                                                <div class="input-group date">
                                                    <div class="input-group-addon">
                                                        <i class="fa fa-calendar"></i>
                                                    </div>
                                                    <vuejs-datepicker v-model="date" id="card_ptp_date"
                                                                      :disabled-dates="disabledDates">
                                                    </vuejs-datepicker>
                                                </div>
                                            </div>

                                            <label for="card_ptp_time" class="col-sm-2 control-label">Time</label>
                                            <div class="col-sm-4">
                                                <div class="input-group">
                                                    <div class="input-group-addon">
                                                        <i class="fa fa-clock-o"></i>
                                                    </div>
                                                    <input type="text" name="card_ptp_time" class="form-control timepicker" id="card_ptp_time">
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <br>
                                    <script>
                                        var ptp = new Vue({
                                            el: '#card_ptpForm',
                                            data: {
                                                date: new Date(),
                                                disabledDates: {
                                                    to: new Date(Date.now() - 8640000)
                                                },
                                            },
                                            components: {
                                                vuejsDatepicker
                                            },
                                            computed: {
                                                getDate() {
                                                    return (this.date.getMonth() + 1) + "-" + this.date.getDate() + "-" + this.date.getFullYear();
                                                }
                                            },
                                        })
                                    </script>
                                </div>
                            </div>

                            <div class="csi-view-form-full-area csi-view-indtable col-sm-6">
                                <div class="box-header with-border csi-view-box-header">
                                    <label class="box-title" >Note Detail</label>
                                </div>
                                <div class="box-body" >
                                    <div id="dailyNoteForm">
                                        <form id="dailyNoteSaveForm" action="" method="post" class="form-horizontal">
                                            <input type="hidden" name="customerBasicInfo.id" v-model="customerId"/>
                                            <div class="modal-body">
                                                <textarea v-model="note"class="form-control note-details-card" rows="7" style="resize: none"
                                                          placeholder="Enter Details Here" name="note"
                                                          th:required="true"></textarea>
                                            </div>
                                        </form>
                                    </div>
                                    <script th:inline="javascript">
                                        /*<![CDATA[*/
                                        var customerId = /*[[${cardCustomerInfo.id}]]*/ [];
                                        /*]]>*/
                                    </script>
                                    <script>
                                        var dailyNote  = new Vue({
                                            el:"#dailyNoteForm",
                                            data:{
                                                customerId:'',
                                                note:''
                                            },
                                            created: function(){
                                                this.customerId = customerId;
                                            },
                                            methods:{
                                                dailyNoteSave(){
                                                   var booleanMesg=false;
                                                    let host = window.location.host;
                                                    this.$http.post("https://" + host + "/collection/card/daily-notes/save",
                                                        {
                                                            note:this.note,
                                                            customerBasicInfo:{id:this.customerId}
                                                        },
                                                        {
                                                            credentials: true,
                                                            headers: {
                                                                "X-CSRF-TOKEN": window.csrfToken
                                                            }
                                                        }).then(function (data) {
                                                        if(data.ok){
                                                            // alert("Successfully saved !!");
                                                            $(".note-details-card").val(" ")
                                                            booleanMesg=true
                                                            dailyNoteApp.getAll(this.customerId);
                                                        }
                                                    }).catch(function (errorText) {
                                                        alert("Something is wrong. Try again please");
                                                    });

                                                    return booleanMesg;
                                                }
                                            }
                                        });

                                    </script>
                                </div>
                            </div>
                        </div>


                        <div class="box-footer">
                            <div style="text-align: center">
                                <button type="button" class="btn btn-danger btn-sm pull-right" data-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-primary btn-sm pull-right" onclick="saveAllActivityTakenCard()">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


            <!--View Modal-->
            <div class="modal fade" id="modal-ptp-view">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" style="text-align: center">PTP</h4>
                        </div>
                        <form id="card_ptpForm-view" action="" method="get" class="form-horizontal">

                                <div class="row top-buffer">
                                    <label class="col-sm-2 custom-details-lebel-left"> Amount :</label>
                                    <label class="col-sm-4 custom-form-lebel" id="card_ptp_amount_view"></label>
                                    <label class="col-sm-2 custom-details-lebel-left">Contact Details :</label>
                                    <label class="col-sm-4 custom-form-lebel" id="card_ptp_contact_view"></label>
                                </div>

                                <div class="row top-buffer">
                                    <label class="col-sm-2 custom-details-lebel-left"> Contact Location: </label>
                                    <label class="col-sm-4 custom-form-lebel" id="card_contact_location_view"></label>
                                    <label class="col-sm-2 custom-details-lebel-left">Promisor Details :</label>
                                    <label class="col-sm-4 custom-form-lebel" id="card_ptp_promisor_view"></label>
                                </div>


                                <div class="row top-buffer">
                                    <label class="col-sm-2 custom-details-lebel-left"> Date : </label>
                                    <label class="col-sm-4 custom-form-lebel" id="card_ptp_date_view"></label>
                                    <label class="col-sm-2 custom-details-lebel-left">Time : </label>
                                    <label class="col-sm-4 custom-form-lebel" id="card_ptp_time_view"></label>
                                </div>


                                <div class="row top-buffer">
                                    <label class="col-sm-2 custom-details-lebel-left"> Creator : </label>
                                    <label class="col-sm-4 custom-form-lebel" id="card_ptp_creator_view"></label>
                                </div>
                        </form>
                        <div class="modal-footer text-center">
                            <button type="button" class="btn btn-danger" id="loan_ptp_btn" data-dismiss="modal" onclick="clearformdisable()">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="box box-primary">
        <div class="box-header with-border">
            <h2 class="box-title" style="margin-top: 10px;">Document Upload</h2>
            <a class=" btn btn-xs btn-primary pull-right" data-toggle="modal" data-target="#modal-manager-recommendation">
                <i class="fa fa-plus-square"></i>
                Add More
            </a>
        </div>
        <div class="box-body" id="recommendation">
            <div class="row">
                <div class="col-md-12">
                    <div style="overflow: auto;">
                        <table name="dairy_notes" id="dms"
                               class=" table   table-bordered">
                            <thead class="thead-light">
                            <tr>
                                <th style="display: none;">Id</th>
                                <th style="display: none;">DMS File Id</th>
                                <th>Creator</th>
                                <th style="text-align: center">Name</th>
                                <th style="text-align: center">Comment</th>
                                <th style="text-align: center">Type</th>
                                <th style="text-align: center">Action</th>
                            </tr>
                            </thead>
                            <tbody id="dms_table">
                            <tr v-for="document in documentUpload">
                                <td style="display: none">{{document.id}}</td>
                                <td style="display: none">{{document.dmsId}}</td>
                                <td>{{document.creatorName}}-{{document.pin}}/{{document.createdDate | dateFormat}}</td>
                                <td style="text-align: center">{{document.name}}</td>
                                <td style="text-align: center">{{document.comments}}</td>
                                <td style="text-align: center">{{document.type}}</td>
                                <td style="text-align: center"><a class="btn btn-success btn-xs" data-toggle="modal" target="_blank"
                                                                  :href="'/collection/dms/document/preview?id=' + document.dmsId + '&type=' + document.type"><i class="fa fa-edit"></i>Preview</a></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
            <div class="modal fade" id="modal-manager-view-recommendation">
                <div class="modal-dialog">
                    <div class="modal-content" style="border-radius: 5px;">
                        <div class="modal-body">
                            <table>
                                <thead class="thead-light">

                                </thead>
                                <tbody class="tbl-row">
                                <tr>
                                    <td>
                                        <input th:id="uploadFileIdPreview" :value="documentProperty.id" type="hidden"/>
                                        <input th:id="docurlPreview" :value="documentProperty.url" type="hidden"/>
                                        <input th:id="doctypePreview" :value="documentProperty.type" type="hidden"/>
                                        <a href="#" onclick="showReportPreview(document.getElementById('uploadFileIdPreview').value,document.getElementById('doctypePreview').value);
                                                                     showReportPreview2(document.getElementById('uploadFileIdPreview').value,document.getElementById('doctypePreview').value);">
                                            <span text="" id="docnamePreview">{{documentProperty.name}}</span>
                                        </a>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                            <iframe id="showPreviewReport" width="900" height="510" frameborder="0" allowfullscreen="allowfullscreen"></iframe>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modal-manager-recommendation">
                <div class="modal-dialog">
                    <div class="modal-content" style="border-radius: 5px;">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" style="text-align: center;">Upload Document</h4>
                        </div>
                        <form id="managerRecommendation" action="" method="post" class="form-horizontal">
                            <input type="hidden" th:value="${cardCustomerInfo.id}" name="customerBasicInfo.id"/>
                            <div class="modal-body">
                                <input type="hidden" id="manager_rec_id" name="id" value=""/>
                                <div class="form-group" id="manager_comment_input">
                                    <label class="col-sm-2 custom-details-lebel-left">Comments</label>
                                    <div class="col-sm-10">
                                        <textarea maxlength="500" v-model="comments" class="form-control" rows="3" placeholder="Commnet" id="manager_comment" name="branchComment"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 custom-details-lebel-left">Upload File.</label>
                                    <div class="fileUpload btn-upload-img col-sm-3">
                                        <input type="file" class="custom-form-control upload ufile" id="mfile_200_0" onchange="mangerfile_preview('200',0);"/>
                                    </div>

                                </div>
                                <div class="form-group">
                                    <div class="col-sm-10 col-sm-offset-2" id="td_200_0" style="position: relative">

                                    </div>
                                </div>

                                <div id="idivpreview" class="col-sm-6" style="display:none;">
                                    <iframe id="iframeMangerCommnet" style="height:270px; width:350px"></iframe>
                                </div>
                            </div>

                            <div class="modal-footer text-center">
                                <button :disabled="disableSaveButton" style="float: right" id="manager_commentbtn_commit" @click.prevent="uploadDocument" class="btn btn-info">Save</button>
                                <button style="float:left" type="button" onclick="commnetFormClear();" class="btn btn-danger" data-dismiss="modal">Close</button>

                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <script th:inline="javascript">
            /*<![CDATA[*/
            var customerIds = /*[[${cardCustomerInfo.id}]]*/ [];

            /*]]>*/
        </script>
        <script>
            new Vue({
                el: '#recommendation',
                data: {
                    comments: "",
                    documentUpload: [],
                    documentProperty: {},
                    disableSaveButton: false,
                },
                created: function () {
                    var url = window.location.origin + '/collection/dms/document/list?id=' + customerIds;
                    fetch(url)
                        .then(res => res.json())
                .then(res => {
                        this.documentUpload = res;
                })
                .catch(err => console.log(err));
                },
                filters: {
                    dateFormat: function (value) {
                        var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                            "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
                        ];
                        if (value != '') {
                            var date = new Date(value);
                            var day = date.getDate();
                            if (day < 10) day = '0' + day;
                            return day + '-' + monthNames[date.getMonth()] + '-' + date.getFullYear().toString();
                        } else {
                            return "";
                        }
                    }
                },
                methods: {
                    uploadDocument: function () {
                        this.disableSaveButton = true;
                        var file = $("#mfile_200_0")[0].files[0];
                        var comment = this.comments;
                        var customer = customerIds;


                        let formData = new FormData();
                        formData.append('file', file);
                        formData.append('id', customer);
                        formData.append('comments', comment);

                        this.$http.post(window.location.origin + '/collection/dms/document/upload', formData, {
                            credentials: true, headers: {
                                'X-CSRF-TOKEN': window.csrfToken,
                                'Content-Type': 'multipart/form-data'
                            }
                        }).then(res => {
                            // console.log(res);
                            if(res.body
                    )
                        {
                            this.documentUpload = res.body;
                            $('#modal-manager-recommendation').modal('hide');
                            this.disableSaveButton = false;
                        }
                    }).
                        catch(err => {
                            console.log(err);
                    })
                    },
                    showDocumentPreview: function (id, name, type) {
                        var url = window.location.origin + '/collection/dms/document/view?id=' + id + '&name=' + name + '&type=' + type;
                        this.$http.get(url,
                            {
                                credentials: true, headers: {
                                    'X-CSRF-TOKEN': window.csrfToken,
                                }
                            }).then(res => {
                            // console.log(res);
                            if(res.body){
                                this.documentProperty = res.body;
                           }
                    }).
                        catch(err => {
                            console.log(err);
                    })
                    }

                }
            })
        </script>
    </div>
    <div class="box box-primary" id="cardComentBox">
        <div class="box-header with-border">
            <h3 class="box-title">Special Note</h3>
        </div>
        <div class="box-body"  style="max-height: 400px;min-height: 300px; overflow: auto;">
            <div class="direct-chat-messages" v-for="comment in comments">
                <!-- Message to the right -->
                <div v-if="userId === comment.senderId" class="direct-chat-msg right">
                    <div class="direct-chat-info clearfix">
                        <span class="direct-chat-name pull-left">{{comment.senderName}}</span>
                        <span class="direct-chat-timestamp pull-right">{{comment.time}}</span>
                    </div>
                    <!-- /.direct-chat-info -->
                   <!-- <img class="direct-chat-img" src="../../../../../../dist/img/user1-128x128.jpg" alt="Message User Image">-->
                    <!-- /.direct-chat-img -->
                    <div class="direct-chat-text">
                        {{comment.msg}}
                    </div>
                    <!-- /.direct-chat-text -->
                </div>
                <!-- /.direct-chat-msg -->


                <!-- Message. Default to the left -->
                <div v-else class="direct-chat-msg ">
                    <div class="direct-chat-info clearfix">
                        <span class="direct-chat-name pull-right">{{comment.senderName}}</span>
                        <span class="direct-chat-timestamp pull-left">{{comment.time}}</span>
                    </div>
                    <!-- /.direct-chat-info -->
                    <!--<img class="direct-chat-img" src="../../../../../../dist/img/user1-128x128.jpg" alt="Message User Image">-->
                    <!-- /.direct-chat-img -->
                    <div class="direct-chat-text">
                        {{comment.msg}}
                    </div>
                    <!-- /.direct-chat-text -->
                </div>
                <!-- /.direct-chat-msg -->
            </div>
        </div>

        <div class="box-footer">
            <form action="#" method="post">
                <div class="input-group">
                    <input type="text" v-model="msg" placeholder="Type Message ..." class="form-control">
                    <span class="input-group-btn">
                        <button type="submit" @click.prevent="send" class="btn btn-primary btn-flat">Send</button>
                      </span>
                </div>
            </form>
        </div>

        <script th:inline="javascript">
            /*<![CDATA[*/
            var customerId = /*[[${cardCustomerInfo.id}]]*/ [];
            /*]]>*/

            async function saveAllActivityTakenCard() {
                var considarationMessage = "";
                var followUpdateMessage = "";
                var resonForDelquencyMesg = "";
                var ptpMesg = "";
                var noteDetailsMesg = "";

                if ($('.consider-attempt-card').val() != '') {
                    var returnData = Promise.resolve(contactSave());
                    await returnData.then(function (v) {
                        considarationMessage = v;
                    });

                }
                if ($('.follow-up-date-card').val() != '') {
                    var returnData = Promise.resolve(save_card_follow_up());
                    await returnData.then(function (v) {
                        followUpdateMessage = v;
                    });

                }
                if ($('.reason-delinquency-card').val() != '') {
                    var returnData = Promise.resolve(saveReasonForDelinquencyCard());
                    await returnData.then(function (v) {
                        resonForDelquencyMesg = v;
                    })
                }
                if ($('.ptp-amount-card').val() != '' && $('#card_ptp_date').val() != '') {
                    var returnData = Promise.resolve(save_card_ptp());
                    await returnData.then(function (v) {
                        ptpMesg = v;
                    })
                }

                if ($('.note-details-card').val() != '') {
                    var returnData = Promise.resolve(dailyNote.dailyNoteSave());
                    await returnData.then(function (v) {
                        noteDetailsMesg = v;
                    })

                }

                if (considarationMessage === true || followUpdateMessage === true || resonForDelquencyMesg === true || ptpMesg === true || noteDetailsMesg === false) {
                    alert("Successfully saved !!");
                    $("#modal-ptp").hide();

                }
            }


        </script>

        <script th:inline="javascript">

            /*<![CDATA[*/
            var customerId = /*[[${cardCustomerInfo.id}]]*/ [];
            /*]]>*/

        </script>

        <script>
            var commentBox = new Vue({
                el: '#cardComentBox',
                data: {
                    msg: '',
                    comments: [],
                    customerID: '',
                    userId: '',
                },
                created: function () {
                    this.customerID = customerId;
                    var url = window.location.origin + '/collection/card/comment/list?id=' + this.customerID;
                    this.$http.get(url, {
                        credentials: true, headers: {
                            'X-CSRF-TOKEN': window.csrfToken,
                        }
                    })
                        .then(res => {
                        if (res.body) {
                        var commentList = res.body.commentList;
                        var userList = res.body.userList;
                        this.userId = res.body.userId;

                        commentList.forEach((c, i) => {
                            var senderId = c.userId;
                        var senderName = userList[i];
                        var time = c.time;
                        var msg = c.msg;

                        this.comments.push({
                            senderId: senderId,
                            senderName: senderName,
                            time: time,
                            msg: msg,
                        });
                    });
                    }
                }).
                    catch(err => {
                        console.log(err);
                })
                },
                methods: {
                    send: function () {
                        this.$http.post(window.location.origin + '/collection/card/comment/save', {
                            customerId: this.customerID,
                            comment: this.msg,
                        }, {
                            credentials: true, headers: {
                                'X-CSRF-TOKEN': window.csrfToken,
                            }
                        }).then(res => {
                            if (res.body) {
                            this.msg = '';
                            this.updateMsg();
                        }
                    }).
                        catch(err => {
                            console.log(err);
                    })
                    },
                    updateMsg: function () {
                        var url = window.location.origin + '/collection/card/comment/list?id=' + this.customerID;
                        this.$http.get(url, {
                            credentials: true, headers: {
                                'X-CSRF-TOKEN': window.csrfToken,
                            }
                        }).then(res => {
                            if(res.body ) {
                            var commentList = res.body.commentList;
                            var userList = res.body.userList;

                            this.comments = [];
                            commentList.forEach((c, i) => {
                                var senderId = c.userId;
                            var senderName = userList[i];
                            var time = c.time;
                            var msg = c.msg;

                            this.comments.push({
                                senderId: senderId,
                                senderName: senderName,
                                time: time,
                                msg: msg,
                            });
                        });
                        }
                    }).
                        catch(err => {
                            console.log(err);
                    })
                    }
                }
            });
        </script>




    </div>
</div>
</body>
</html>
