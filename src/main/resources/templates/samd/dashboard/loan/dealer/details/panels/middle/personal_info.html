<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="ISO-8859-1"></meta>
    <title>Account list</title>
</head>
<body>
<div id="layout-cibReport" th:fragment="personal-info">

    <style>
        .tableFixHead {
            overflow-y: auto;
            height: 700px;
        }

        .tableFixHead thead th {
            position: sticky;
            top: 0;
        }

        table {
            border-collapse: collapse;
            width: 100%;
        }

        th, td {
            padding: 8px 16px;
        }

        th {
            background: #eee;
        }
    </style>


    <div class="tableFixHead">
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>SL</th>
                        <th>Account No</th>
                        <th>Contact</th>
                        <th>No Contact</th>

                        <th>Broken PTP</th>
                        <th>Kept PTP</th>
                        <th>Cured PTP</th>

                        <th>Save Amount</th>
                        <th>Back Amount</th>
                        <th>Flow Amount</th>
                        <th style="min-width: 100px">Follow Up Date</th>

                        <th>Payment (Current Month)</th>
                        <th>Last Payment</th>
                        <th>Last Payment Date</th>

                        <th>Overdue Amount</th>
                        <th>Branch Name</th>
                        <th>Bucket</th>

                        <th>Link Account No</th>
                        <th>Link Account Balance</th>
                        <th>Risk Category</th>
                    </tr>
                </thead>

                <tbody id="samd-account-details-tbody">

                </tbody>
            </table>
        </div>

        <script>
            /* Fetch Account Details Informations On Tabe Change */
            $('#tab-pd').click(function () {
                getSamdAccountDetails();
            });

            /* Fetch Account Details Informations On Load */
            getSamdAccountDetails();

            function getSamdAccountDetails(){
                var dealerPin = $("#globalUserPinForSummary").val()
                $('#samd-account-details-tbody').html('');
                $.ajax({
                    type: 'GET',
                    url: '/collection/samd/loan/dashboard/account-details?dealerPin='+dealerPin,
                    success: function (response) {
                        $.each(response, function (index, data) {
                            var tr = ''
                                + '<tr>'
                                +   '<td>'+(index+1)+'</td>'
                                +   '<td><a target="_blank" href="/profile/loanprofile/search?account=' +data.accountNo+ '">' +data.accountNo+ '</a></td>'
                                +   '<td class="text-center">'+data.contact+'</td>'
                                +   '<td class="text-center">'+data.noContact+'</td>'

                                +   '<td class="text-center">'+data.brokenPtp+'</td>'
                                +   '<td class="text-center">'+data.keptPtp+'</td>'
                                +   '<td class="text-center">'+data.curedPtp+'</td>'

                                +   '<td class="text-right">'+numberToBDTFormat(data.saveAmount)+'</td>'
                                +   '<td class="text-right">'+numberToBDTFormat(data.backAmount)+'</td>'
                                +   '<td class="text-right">'+numberToBDTFormat(data.flowAmount)+'</td>'
                                +   '<td class="text-center">'+data.followUpDate+'</td>'

                                +   '<td class="text-right">'+numberToBDTFormat(data.currentMonthPayment)+'</td>'
                                +   '<td class="text-right">'+numberToBDTFormat(data.lastPayment)+'</td>'
                                +   '<td class="text-center">'+data.lastPaymentDate+'</td>'

                                +   '<td class="text-right">'+numberToBDTFormat(data.overdueAmount)+'</td>'
                                +   '<td>'+data.branchName+'</td>'
                                +   '<td class="text-center">'+data.dpdBucket+'</td>'

                                +   '<td>'+(data.linkAccountNo ? data.linkAccountNo : '')+'</td>'
                                +   '<td class="text-right">'+numberToBDTFormat(data.linkAccountBalance)+'</td>'
                                +   '<td>'+data.riskCategory+'</td>'
                                + '</tr>'
                            $('#samd-account-details-tbody').append(tr)
                        })
                    }
                })
            }
        </script>
    </div>


</div>
</body>


</html>
