<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="legal/layouts/main/main-layout">
<head>
    <meta charset="UTF-8">
    <title th:text="${reportTitle}"></title>
    <link rel="stylesheet" href="/css/datatables-utils/buttons.dataTables.min.css">
</head>
<body>
<div layout:fragment="content">
    <div class="content-wrapper">
        <div class="content">
            <div class="row">
                <div class="col-xs-12">
                    <div class="box box-info">
                        <div class="box-header with-border text-center">
                            <div class="box-title" th:text="${reportTitle}"></div>

                            <div id="isLoading" class="col-xs-1 pull-right" style="display: none">
                                <div class="circle-half-loader"></div>
                            </div>
                        </div>

                        <div class="box-body">

                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-condensed text-center report-table"
                                       cellspacing="0" width="100%">
                                    <thead><!--
                                    <tr>
                                        <th colspan="24">
                                            Case Filling Year wise Report
                                        </th>
                                    </tr>-->
                                    <tr>
                                        <th>SL#</th>
                                        <th>Branch Code</th>
                                        <th>Branch Name</th>
                                        <th>CIF</th>
                                        <th>Account No</th>
                                        <th>Account Name</th>
                                        <th>Borrower/ Defendant Name</th>
                                        <th>Segment</th>
                                        <th>LD. Number</th>
                                        <th>Plaintiffâ€™s Name</th>
                                        <th>Defendant/ Accused Name</th>
                                        <th>Defendant/ Accused Mobile#</th>
                                        <th>Suit Number</th>
                                        <th>Date of Filing</th>
                                        <th>Case Amount</th>
                                        <th>CL Status</th>
                                        <th>Total Recovery</th>
                                        <th>Outstanding</th>
                                        <th>Next Date</th>
                                        <th>Course of Action</th>
                                        <th>COMMENT ON THE PROBABILITY OF THE OUTCOME AND ITS IMPACT ON THE BANK</th>
                                        <th>Lawyer's Name</th>
                                        <th>Lawyer's Cell Number</th>
                                        <th>Remarks</th>
                                    </tr>
                                    </thead>
                                    <tbody id="moneySuitAgainstBankTbody">


                                    </tbody>
                                </table>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/common.js"></script>

    <script>

        var isLoading = false;

        function moneySuitAgainstBankSearch() {

            if (isLoading) {
                swal("Please wait...");
                return;
            }

            isLoading = true;

            $('#isLoading').show();

            var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");

            $.ajax({
                url: '/legal/report/money-suit-filed-against-the-bank/report',
                type: 'GET',

                beforeSend: function (xhr) {
                    xhr.setRequestHeader(header, token);
                },
                success: function (data) {

                    if (!Array.isArray(data)) {
                        swal("Something went wrong");
                        return;
                    }

                    $('#moneySuitAgainstBankTbody').replaceWith("<tbody id='moneySuitAgainstBankTbody' >\n" +
                        "\t\t\t\t\t\t\t</tbody>");
                    for (var i = 0; i < data.length; i++) {
                        if (data[i] != null) {
                            var str = "<tr>" +
                                "<td>" + getStringValueOrDash(data[i].sl) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].branchName) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].branchCode) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].cif) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].accountNo) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].accountName) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].borrowerName) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].segment) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].ldNo) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].plaintiffName) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].defendantName) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].defendantMobile) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].suitNumber) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].dateOfFiling) + "</td>" +
                                "<td>" + data[i].caseAmount + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].clStatus) + "</td>" +
                                "<td>" + data[i].totalRecovery + "</td>" +
                                "<td>" + data[i].outstanding + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].nextDate) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].courseOfAction) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].commentOnOutcomeAndImpactOnBank) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].lawyers) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].lawyersPhone) + "</td>" +
                                "<td>" + getStringValueOrDash(data[i].remarks) + "</td>" +
                                "</tr>";
                            $('#moneySuitAgainstBankTbody').append(str);
                        }
                    }
                    isLoading = false;
                    $('#isLoading').hide();
                },
                error: function (err) {
                    isLoading = false;
                    $('#isLoading').hide();
                    swal("Something went wrong");

                }
            });
        }

        $(document).ready(function () {

            moneySuitAgainstBankSearch();

            $('.report-table').DataTable({
                paging: false,
                ordering: false,
                dom: 'Bfrtip',
                buttons: [
                    'csv', 'excel', 'print'
                ]
            });
        });

    </script>
</div>
</body>
</html>