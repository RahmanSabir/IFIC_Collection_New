<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="legal/layouts/main/main-layout">
<head>
    <meta charset="UTF-8">
    <title th:text="${reportTitle}"></title>
    <link rel="stylesheet" th:href="@{/css/legal-report.css}"/>
    <style media="print">
        @page {
            size: A4 landscape; margin: 0.4in 0.4in 0.6in 0.39in;
        }
        .borderless{
            border: none; !important;
        }
        table, th, td{
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
<div layout:fragment="content">
    <div class="content-wrapper">
        <div class="content" id="report-app">
            <div class="row">
                <div class="col-xs-12">
                    <div class="box">
                        <div class="box-body">
                            <div class="row margin">
                                <div class="col-sm-1">
                                    From :
                                </div>
                                <div class="col-sm-2">
                                    <input type="date" v-model="startDate"  class="form-control"/>
                                </div>
                                <div class="col-sm-1">
                                    To :
                                </div>
                                <div class="col-sm-2">
                                    <input type="date" v-model="endDate"  class="form-control"/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 text-center">
                                    <button class="btn btn-sm btn-primary pull-right margin" @click="getReport">
                                        Report
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="row">
                    <div class="col-sm-12 margin">
                        <button onclick="printElementIncludingStyles('printBody')"
                                class="btn btn-sm btn-primary">
                            Print
                        </button>
                    </div>
                </div>
                <div class="col-xs-12">
                    <div id="printBody" class="box">
                        <div class="box-body">
                            <div class="col-sm-12">
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th colspan="50" class="borderless" style="text-align: center;">
                                            সিআইবি সংশ্লিষ্ঠ রীট পিটিশনের (বছর ভিত্তিক) অগ্রগতির ত্রৈমাসিক বিবরণী |
                                            <br>
                                            (জানুয়ারী-মার্চ, ত্রৈমাসিক, ২০২১ ইং)
                                        </th>
                                        <th colspan="6" class="borderless" style="text-align: center;">সংযোজনী - এল</th>
                                    </tr>
                                    <tr>
                                        <th colspan="2" style="text-align: center">১</th>
                                        <th colspan="5" style="text-align: center">২</th>
                                        <th colspan="7" style="text-align: center">৩</th>
                                        <th colspan="9" style="text-align: center">৪</th>
                                        <th colspan="9" style="text-align: center">৫</th>
                                        <th colspan="10" style="text-align: center">৬</th>
                                        <th colspan="6" style="text-align: center">৭</th>
                                        <th colspan="8" style="text-align: center">৮</th>
                                    </tr>
                                    <tr>
                                        <th colspan="2" style="text-align: center; font-size: 8px;">ক্রমিক <br> নং</th>
                                        <th colspan="5" style="text-align: center; font-size: 8px;">রীট পিটিশন নম্বর</th>
                                        <th colspan="7" style="text-align: center; font-size: 8px;">বাদীর নাম (ব্যক্তি/প্রতিষ্ঠান)</th>
                                        <th colspan="9" style="text-align: center; font-size: 8px;">
                                            বাদী সংশ্লিষ্ট ঋণ গ্রহীতা প্রতিষ্ঠানের
                                            <br>
                                            নাম (বাদী ব্যক্তি হলে)
                                        </th>
                                        <th colspan="9" style="text-align: center; font-size: 8px;">
                                            রীট পিটিশনে নিয়োজিত আইনজীবীর
                                            <br>
                                            নাম ও মোবাইল নম্বর
                                        </th>
                                        <th colspan="10" style="text-align: center; font-size: 8px;">রীট পিটিশনের সর্বশেষ অর্জিত অগ্রগতি
                                        </th>
                                        <th colspan="6" style="text-align: center; font-size: 8px;">রায় হয়ে থাকলে রায়ের <br> বিবরণ
                                            (কপিসহ)
                                        </th>
                                        <th colspan="8" style="text-align: center; font-size: 8px;">মন্তব্য</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr v-for="(suit,index) in data">
                                        <td colspan="2" class="wrap-word" style="text-align: center; font-size: 8px">{{index + 1}}</td>
                                        <td colspan="5" class="wrap-word" style="text-align: left; font-size: 8px">{{suit.writPetitionNumber}}</td>
                                        <td colspan="7" class="wrap-word" style="text-align: left; font-size: 8px">{{suit.defendantName}}</td>
                                        <td colspan="9" class="wrap-word" style="text-align: left; font-size: 8px">{{suit.accountName}}</td>
                                        <td colspan="9" class="wrap-word" style="text-align: left; font-size: 8px">
                                            {{suit.lawyerName}}
                                            <br>
                                            {{suit.lawyerPhone ? 'Mobile No.- ' +
                                            suit.lawyerPhone.split(',')[0]: ''}}
                                        </td>
                                        <td colspan="10" class="wrap-word" style="text-align: left; font-size: 8px">{{suit.caseStatus}}</td>
                                        <td colspan="6" class="wrap-word" style="text-align: left; font-size: 8px">{{suit.courseOfAction}}</td>
                                        <td colspan="8" class="wrap-word" style="text-align: left; font-size: 8px">{{suit.remarks}}</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            var customerWiseReportApp = new Vue({
                el: '#report-app',
                components: {
                    Multiselect: VueMultiselect.default
                },
                data: {
                    startDate: '',
                    endDate: '',
                    data: [],
                    isLoading: false
                },
                created: function () {
                    this.startDate = "2021-01-01";
                    this.endDate = new Date().toISOString().substring(0, 10);
                },
                filters: {
                    formatCurrency(value) {
                        return formatBdtInEnglish(value);
                    }
                },
                methods: {
                    getReport: function (e) {
                        e.preventDefault();
                        let vm = this;
                        vm.isLoading = true;

                        let host = window.location.host;
                        let url = 'https://' + host + '/legal/report/bangladesh-bank-reports/cib-writ-petition/report?' + 'startDate=' + vm.startDate + '&endDate=' + vm.endDate;
                        vm.$http.get(url)
                            .then(res => {
                                if (res.ok) {
                                    if (typeof res.body === 'string' && res.body.contains('login')) {
                                        notifyError();
                                    } else {
                                        vm.data = res.body;
                                    }
                                    vm.isLoading = false;
                                }
                            }).catch(err => {
                            notifyError();
                            vm.isLoading = false;
                        })
                    },
                    removeData: function (index) {
                        this.data.splice(index, 1);
                    },
                    print: function () {
                        printElementIncludingStyles('printBody');
                    },
                }
            })
        </script>
    </div>

</div>

</body>
</html>